title: WordPress迁移到Hexo
id: 16130
date: 2016-01-30 03:57:29
tags:
categories:
  - Life
---

使用插件 [hexo-migrator-wordpress](https://github.com/hexojs/hexo-migrator-wordpress)

Export your WordPress in "Tools" → "Export" → "WordPress" in your dashboard.
Execute the following command after installed. source is the file path or URL of WordPress export file.

```
$ npm install hexo-migrator-wordpress --save
$ hexo migrate wordpress <source>
```
<!--more-->
s
现有问题是不能处理文章标题中的中文和特殊符号。

从Wordpress迁移过来时，生成的文件名会出现如下例子
`e8-bd-af-e8-bf-9e-e6-8e-a5-e5-92-8c-e7-a1-ac-e8-bf-9e-e6-8e-a5.md`
因为URL中，中文是UTF-8编码。解决办法是写了一个Python脚本，然后从文件内容的id部分提取出文件名，代码如下：

```Python
import os,sys,re

def getTitle(firstLine):
    strs = ':'.join(firstLine.split(':')[1:])
    strs = strs.replace("'", '') 
    strs = strs.strip()
    title = '-'.join(strs.split(' '))
    return title
    
if __name__ == "__main__":
    dirName = sys.argv[1]
    for root,dirs,fileNames in os.walk(dirName):
        for fileName in fileNames:
            print "Old file:"+fileName 
            # print root
            fileName = os.path.join(root, fileName)
            f = open(fileName)
            
            # Get id 
            for line in f: 
                match=re.findall('^id:',line)
                if match != []: 
                    break;
            
            title = getTitle(line)
            f.close()
            
            newname = title + '.md'
            print "New file:"+newname
            os.rename(fileName, os.path.join(root,newname))
```

如果脚本出错的花，就是标题中出现了特殊的符号，劲量保证id中没有其他的符号。
也可以使用title，但是那个就比较麻烦需要是全英文的。

使用方法:
> python convert.py source/_posts/

然后需要替换所有文本中的图片地址，这个需要看个人情况的。
我只需要修改域名就行，所以本地用notepad++来批量替换了。

然后使用七牛的CDN
使用了一个python的客户端脚本，用来上传图片。
[](https://github.com/heqingpan/qiniu_sync)


